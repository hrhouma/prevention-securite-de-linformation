# Choix de Laboratoire

Chers Ã©tudiants, pour notre prochain laboratoire sur la gestion des permissions et des utilisateurs sous Linux, vous avez le choix entre cinq options diffÃ©rentes. Chaque option est conÃ§ue pour renforcer vos compÃ©tences et votre comprÃ©hension de diffÃ©rents aspects de la sÃ©curitÃ© et de la gestion des systÃ¨mes sous Linux. Veuillez lire attentivement chaque option et choisir celle qui correspond le mieux Ã  vos intÃ©rÃªts et objectifs d'apprentissage.

#### **Option 1: Gestion des Permissions et des Utilisateurs sur Kali Linux et Ubuntu 22.04**
- **Focus**: Utilisation de commandes basiques comme `chmod`, `chown`, `useradd`, et `visudo`.
- **CompÃ©tences clÃ©s**: CrÃ©ation de fichiers, modification de permissions, gestion de l'accÃ¨s utilisateur, et sÃ©curisation des privilÃ¨ges administratifs.

#### **Option 2: Gestion des Permissions sous Linux avec Ubuntu 22.04**
- **Focus**: Processus dÃ©taillÃ© de crÃ©ation de l'environnement, crÃ©ation des utilisateurs, et gestion des permissions de fichiers et de rÃ©pertoires.
- **CompÃ©tences clÃ©s**: CrÃ©ation de fichiers et rÃ©pertoires, attribution initiale de permissions, tests interactifs des permissions.

#### **Option 3: Laboratoire Approfondi sur Kali Linux**
- **Focus**: Approche dÃ©taillÃ©e sur l'utilisation des commandes `chmod`, `chown`, `useradd`, et `usermod`.
- **CompÃ©tences clÃ©s**: Gestion des permissions de fichiers, crÃ©ation et modification d'utilisateurs, utilisation avancÃ©e de la ligne de commande.

#### **Option 4: CrÃ©ation et Gestion des Utilisateurs et Permissions dans Linux**
- **Focus**: MÃ©thodes multiples pour ajouter des utilisateurs au groupe `sudoers`, y compris l'utilisation de scripts et Ansible pour l'automatisation.
- **CompÃ©tences clÃ©s**: CrÃ©ation d'utilisateurs, ajout aux sudoers via diffÃ©rentes mÃ©thodes, scripts d'automatisation.

#### **Option 5: Gestion Pratique des Utilisateurs et Permissions**
- **Focus**: CrÃ©ation de plusieurs utilisateurs et attribution de permissions spÃ©cifiques sur des fichiers, dossiers, et scripts.
- **CompÃ©tences clÃ©s**: Configuration dÃ©taillÃ©e des ACLs, tests pratiques des permissions, gestion sÃ©curisÃ©e des accÃ¨s.

### Instructions de SÃ©lection
AprÃ¨s avoir Ã©valuÃ© les options, veuillez sÃ©lectionner celle qui vous intÃ©resse le plus pour le laboratoire. Cette sÃ©lection nous aidera Ã  personnaliser les sessions en fonction des intÃ©rÃªts de chacun et Ã  assurer une expÃ©rience d'apprentissage optimale. Partagez votre choix avec votre instructeur avant la date prÃ©vue pour le laboratoire.

Nous vous encourageons Ã  explorer les options qui vous pousseront Ã  dÃ©velopper de nouvelles compÃ©tences et Ã  approfondir votre comprÃ©hension de la gestion des systÃ¨mes sous Linux.



ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡
# OPTION 1 
ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡

### Exercice Pratique CombinÃ© sur la Gestion des Permissions et des Utilisateurs sur Kali Linux et Ubuntu 22.04

#### Introduction
Cet exercice vous guide Ã  travers les commandes de gestion des permissions et des utilisateurs sur Kali Linux et Ubuntu 22.04. Vous apprendrez Ã  utiliser `chmod`, `chown`, `useradd`, `usermod`, et `visudo` pour gÃ©rer les permissions des fichiers, des utilisateurs, et des groupes.

#### PrÃ©requis
- Une machine avec Kali Linux ou Ubuntu 22.04 installÃ©.
- AccÃ¨s root ou un utilisateur avec des privilÃ¨ges sudo.

### Partie 1: Gestion des Permissions avec `chmod`

#### a. CrÃ©er et gÃ©rer un fichier de test
```bash
touch monfichier1.txt
touch monfichier2.txt
touch monfichier3.txt
chmod u+x monfichier1.txt  # Ajoute la permission d'exÃ©cution pour l'utilisateur
chmod +x monfichier2.txt   # Ajoute la permission d'exÃ©cution pour tous
chmod g+w monfichier3.txt  # Ajoute la permission d'Ã©criture pour le groupe
ls -l monfichier1.txt
ls -l monfichier2.txt
ls -l monfichier3.txt
```
Vous observerez les changements de permissions aprÃ¨s chaque commande.

### Partie 2: Gestion des Utilisateurs et Groupes

#### a. CrÃ©ation et gestion de nouveaux utilisateurs
```bash
sudo useradd -m nouvelutilisateur  # CrÃ©e un nouvel utilisateur avec un rÃ©pertoire personnel
ls -l /home                         # Voir le rÃ©pertoire crÃ©Ã© pour cet utilisateur + les permissions accordÃ©es
sudo passwd nouvelutilisateur      # DÃ©finit un mot de passe pour le nouvel utilisateur
sudo usermod -aG sudo nouvelutilisateur  # Ajoute l'utilisateur au groupe sudo
groups nouvelutilisateur           # VÃ©rifie les groupes de l'utilisateur
```
# application 1 :  CrÃ©ez un utilisateur avec votre nom et reÃ©xÃ©cutez les mÃªmes commandes ci-haut.
# application 2 :  dÃ©connectez vous de la machine linux et reconnecter avec votre utilisateur + mot de passe.
# application 3 :  dÃ©connectez vous de la machine linux et reconnecter avec l'utilisateur proncipal que vous aviez dÃ©jÃ .

#### b. Manipulation avancÃ©e des utilisateurs
```bash
sudo deluser nouvelutilisateur sudo  # Retire l'utilisateur du groupe sudo
sudo deluser --remove-home nouvelutilisateur  # Supprime l'utilisateur et son rÃ©pertoire personnel
```

# application 4 :  Retirevotre utilisateur du groupe sudo
# application 5 :  Supprimer votre utilisateur et son rÃ©pertoire personnel, vÃ©rifier avec la commande suivante : (ls -l /home) .

### Partie 3: Utilisation de `chown` et `chgrp`

#### a. Changer la propriÃ©tÃ© d'un fichier
```bash
touch fichierpourchown.txt
sudo chown nouvelutilisateur fichierpourchown.txt  # Change le propriÃ©taire
sudo chgrp sudo fichierpourchown.txt               # Change le groupe
ls -l fichierpourchown.txt
```

### Partie 4: Modification Directe du Fichier Sudoers

#### a. Ajout sÃ©curisÃ© d'un utilisateur au fichier sudoers
```bash
sudo visudo
```
Dans l'Ã©diteur qui s'ouvre, ajoutez la ligne suivante pour donner Ã  `nouvelutilisateur` la possibilitÃ© d'exÃ©cuter toutes les commandes:
```
nouvelutilisateur ALL=(ALL:ALL) ALL
```
Utilisez `Ctrl+X`, puis `Y` pour enregistrer et quitter si vous utilisez `nano` comme Ã©diteur dans `visudo`.

### Conclusion

Ce laboratoire pratique vous a montrÃ© comment gÃ©rer efficacement les permissions des fichiers et les utilisateurs sur les systÃ¨mes Kali Linux et Ubuntu 22.04. Vous avez appris les commandes essentielles pour la modification des permissions, la gestion des utilisateurs, et la sÃ©curisation de l'accÃ¨s administratif. Utilisez [Explainshell](https://explainshell.com/) pour des explications dÃ©taillÃ©es sur les commandes et les options.

ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡
# OPTION 2
ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡

### Objectifs du Laboratoire
- Comprendre les bases des permissions sous Linux.
- CrÃ©er et gÃ©rer des utilisateurs et des groupes.
- Appliquer et modifier les permissions de fichiers et de rÃ©pertoires.
- Tester les permissions en se connectant avec diffÃ©rents utilisateurs.

### PrÃ©requis
- Un PC avec Ubuntu 22.04 installÃ©.
- Droits d'administrateur sur la machine.

### Ã‰tape 1: CrÃ©ation de l'Environnement
1. **Ouverture d'un Terminal**: Demandez aux Ã©tudiants d'ouvrir un terminal.
2. **Mise Ã  jour du systÃ¨me**:
   ```bash
   sudo apt update && sudo apt upgrade
   ```

### Ã‰tape 2: CrÃ©ation des Utilisateurs
1. **CrÃ©er plusieurs utilisateurs**:
   ```bash
   sudo adduser etudiant1
   sudo adduser etudiant2
   ```
   RÃ©pÃ©tez pour autant d'utilisateurs que nÃ©cessaire.

### Ã‰tape 3: CrÃ©ation et Gestion des Permissions
1. **CrÃ©er un fichier et un rÃ©pertoire pour tester les permissions**:
   ```bash
   touch fichier_test
   mkdir dossier_test
   ```
2. **Attribuer des permissions initiales**:
   ```bash
   sudo chown etudiant1:etudiant1 fichier_test
   sudo chmod 764 fichier_test
   sudo chown etudiant1:etudiant1 dossier_test
   sudo chmod 775 dossier_test
   ```

### Ã‰tape 4: Modification et VÃ©rification des Permissions
1. **Modifier les permissions**:
   ```bash
   sudo chmod 774 fichier_test
   ```
2. **VÃ©rifier les permissions avec un autre utilisateur**:
   - Demandez aux Ã©tudiants de se dÃ©connecter et de se reconnecter avec `etudiant2`.
   - Tester l'accÃ¨s:
     ```bash
     cat fichier_test
     cd dossier_test
     touch test_inside
     ```

### Ã‰tape 5: Tableau RÃ©capitulatif des Permissions
CrÃ©ez un tableau rÃ©capitulatif pour que les Ã©tudiants puissent suivre les permissions attribuÃ©es et les rÃ©sultats attendus lors des tests:

| Utilisateur  | Fichier / RÃ©pertoire | Permissions | Action de Test | RÃ©sultat Attendu |
|--------------|----------------------|-------------|----------------|------------------|
| etudiant1    | fichier_test         | 774         | `cat`          | SuccÃ¨s           |
| etudiant2    | fichier_test         | 774         | `cat`          | Permission refusÃ©e |
| etudiant1    | dossier_test         | 775         | `touch test`   | SuccÃ¨s           |
| etudiant2    | dossier_test         | 775         | `touch test`   | SuccÃ¨s           |

### Ã‰tape 6: Conclusion et Questions de RÃ©flexion
- **Questions pour les Ã©tudiants**: Qu'arrive-t-il si on change les permissions en 660 pour `fichier_test` et qu'un des utilisateurs essaie de lire le fichier?
- **RÃ©flexion**: Comment les permissions affectent-elles la sÃ©curitÃ© du systÃ¨me?

Ce laboratoire devrait offrir une introduction complÃ¨te et pratique Ã  la gestion des permissions sous Linux, tout en assurant que les Ã©tudiants comprennent chaque Ã©tape grÃ¢ce Ã  des explications dÃ©taillÃ©es et des tests interactifs.

ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡
# OPTION 3
ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡

#### Introduction
Cet exercice vous guidera Ã  travers plusieurs commandes de gestion des permissions et des utilisateurs sur Kali Linux. Vous apprendrez Ã  utiliser `chmod`, `chown`, `useradd`, `usermod`, et d'autres commandes pour gÃ©rer les permissions des fichiers et des utilisateurs. Utilisez [Explainshell](https://explainshell.com/) pour obtenir des explications dÃ©taillÃ©es sur les commandes et les options si quelque chose n'est pas clair.

#### PrÃ©requis
- Une machine avec Kali Linux installÃ©.
- AccÃ¨s root ou un utilisateur avec des privilÃ¨ges sudo.

### 1. Les Permissions avec `chmod`

#### a. CrÃ©er un fichier de test
```bash
touch monfichier.txt
```
`touch` crÃ©e un nouveau fichier vide nommÃ© `monfichier.txt`.

```bash
ls -l monfichier.txt
```
`ls -l` affiche les dÃ©tails du fichier, y compris les permissions, le propriÃ©taire, et le groupe. Vous verrez quelque chose comme :
```
-rw-r--r-- 1 votreutilisateur votreutilisateur 0 date heure monfichier.txt
```
- `-rw-r--r--` : Indique les permissions du fichier (lecture/Ã©criture pour le propriÃ©taire, lecture seule pour le groupe et les autres).
- `1` : Nombre de liens.
- `votreutilisateur` : PropriÃ©taire du fichier.
- `votreutilisateur` : Groupe du fichier.
- `0` : Taille du fichier (en octets).
- `date heure` : Date et heure de la derniÃ¨re modification.
- `monfichier.txt` : Nom du fichier.

#### b. Ajouter la permission d'exÃ©cution pour l'utilisateur (`u+x`)
```bash
chmod u+x monfichier.txt
```
`chmod u+x` ajoute la permission d'exÃ©cution pour l'utilisateur propriÃ©taire du fichier.

```bash
ls -l monfichier.txt
```
Vous verrez maintenant :
```
-rwxr--r-- 1 votreutilisateur votreutilisateur 0 date heure monfichier.txt
```
- `-rwxr--r--` : Le `x` ajoutÃ© pour l'utilisateur indique que l'utilisateur peut exÃ©cuter le fichier.

#### c. Ajouter la permission d'exÃ©cution pour tout le monde (`+x`)
```bash
chmod +x monfichier.txt
```
`chmod +x` ajoute la permission d'exÃ©cution pour tout le monde (utilisateur, groupe, et autres).

```bash
ls -l monfichier.txt
```
Vous verrez :
```
-rwxr-xr-x 1 votreutilisateur votreutilisateur 0 date heure monfichier.txt
```
- `-rwxr-xr-x` : Le `x` ajoutÃ© pour tous indique que tout le monde peut exÃ©cuter le fichier.

#### d. Ajouter les permissions d'Ã©criture pour le groupe (`g+w`)
```bash
chmod g+w monfichier.txt
```
`chmod g+w` ajoute la permission d'Ã©criture pour le groupe.

```bash
ls -l monfichier.txt
```
Vous verrez :
```
-rwxrwxr-x 1 votreutilisateur votreutilisateur 0 date heure monfichier.txt
```
- `-rwxrwxr-x` : Le `w` ajoutÃ© pour le groupe indique que les membres du groupe peuvent Ã©crire dans le fichier.

### 2. Gestion des Utilisateurs

#### a. CrÃ©er un nouvel utilisateur
```bash
sudo useradd -m nouvelutilisateur
```
- `sudo` : ExÃ©cute la commande avec des privilÃ¨ges administratifs.
- `useradd` : Commande pour ajouter un nouvel utilisateur.
- `-m` : CrÃ©e un rÃ©pertoire personnel pour le nouvel utilisateur.

```bash
sudo passwd nouvelutilisateur
```
- `passwd` : Change le mot de passe de l'utilisateur spÃ©cifiÃ©.

#### b. Ajouter l'utilisateur au groupe sudo
```bash
sudo usermod -aG sudo nouvelutilisateur
```
- `usermod` : Modifie un utilisateur.
- `-aG` : Ajoute l'utilisateur Ã  un groupe sans supprimer l'utilisateur d'autres groupes.

#### c. VÃ©rifier l'appartenance au groupe sudo
```bash
groups nouvelutilisateur
```
`groups` affiche les groupes auxquels appartient l'utilisateur spÃ©cifiÃ©.

#### d. Retirer l'utilisateur du groupe sudo
```bash
sudo deluser nouvelutilisateur sudo
```
`deluser` supprime l'utilisateur du groupe spÃ©cifiÃ©.

#### e. Supprimer l'utilisateur
```bash
sudo deluser --remove-home nouvelutilisateur
```
- `--remove-home` : Supprime le rÃ©pertoire personnel de l'utilisateur en mÃªme temps que l'utilisateur.

### 3. Utilisation de `chown` et `chgrp`

#### a. CrÃ©er un fichier de test
```bash
touch fichierpourchown.txt
```
`touch` crÃ©e un nouveau fichier vide nommÃ© `fichierpourchown.txt`.

#### b. Changer le propriÃ©taire du fichier
```bash
sudo chown nouvelutilisateur fichierpourchown.txt
```
`chown` change le propriÃ©taire du fichier spÃ©cifiÃ©.

```bash
ls -l fichierpourchown.txt
```
Vous verrez quelque chose comme :
```
-rw-r--r-- 1 nouvelutilisateur votreutilisateur 0 date heure fichierpourchown.txt
```
- `nouvelutilisateur` : Nouveau propriÃ©taire du fichier.

#### c. Changer le groupe du fichier
```bash
sudo chgrp sudo fichierpourchown.txt
```
`chgrp` change le groupe du fichier spÃ©cifiÃ©.

```bash
ls -l fichierpourchown.txt
```
Vous verrez :
```
-rw-r--r-- 1 nouvelutilisateur sudo 0 date heure fichierpourchown.txt
```
- `sudo` : Nouveau groupe du fichier.

#### d. Changer Ã  la fois le propriÃ©taire et le groupe
```bash
sudo chown votreutilisateur:sudo fichierpourchown.txt
```
`chown` change le propriÃ©taire et le groupe du fichier spÃ©cifiÃ©.

```bash
ls -l fichierpourchown.txt
```
Vous verrez :
```
-rw-r--r-- 1 votreutilisateur sudo 0 date heure fichierpourchown.txt
```
- `votreutilisateur:sudo` : Nouveau propriÃ©taire et groupe du fichier.

### Conclusion

Cet exercice vous a montrÃ© comment utiliser les commandes de base pour gÃ©rer les permissions des fichiers et les utilisateurs sur Kali Linux. Vous avez appris Ã  utiliser `chmod` pour modifier les permissions des fichiers, `chown` et `chgrp` pour changer les propriÃ©taires et les groupes, ainsi que les commandes `useradd`, `usermod`, et `deluser` pour gÃ©rer les utilisateurs. Utilisez [Explainshell](https://explainshell.com/) pour des explications dÃ©taillÃ©es sur les commandes et les options.

Ces compÃ©tences sont essentielles pour administrer efficacement un systÃ¨me Linux, en particulier dans un environnement de sÃ©curitÃ© comme Kali Linux.

ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡
# OPTION 4
ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡

### CrÃ©ation et gestion des utilisateurs dans Linux : Ajout aux sudoers

Pour crÃ©er des utilisateurs et les ajouter au groupe `sudoers` (qui leur donne des privilÃ¨ges administratifs), il existe plusieurs mÃ©thodes dÃ©taillÃ©es ci-dessous. **Remarque : La mÃ©thode 5 utilisant Ansible n'est pas obligatoire et peut Ãªtre ignorÃ©e par les Ã©tudiants.**

# MÃ©thode 1 : Utiliser la ligne de commande

1. **CrÃ©er un nouvel utilisateur nommÃ© Albert :**
   ```bash
   sudo adduser albert
   ```

   Cette commande vous demandera de fournir des informations comme le mot de passe, le nom complet, etc.

2. **Ajouter l'utilisateur Albert au groupe sudo :**
   ```bash
   sudo usermod -aG sudo albert
   ```

   `-aG` signifie "append" (ajouter) et "group" (groupe). Cette commande ajoute l'utilisateur au groupe sudo sans retirer ses autres appartenances aux groupes.

3. **VÃ©rifier qu'Albert est bien dans le groupe sudo :**
   ```bash
   groups albert
   ```

   Cette commande affichera les groupes auxquels appartient Albert, y compris `sudo` s'il a Ã©tÃ© ajoutÃ© correctement.

# MÃ©thode 2 : Modifier directement le fichier sudoers

1. **Ouvrir le fichier sudoers avec visudo :**
   ```bash
   sudo visudo
   ```

   `visudo` est l'Ã©diteur recommandÃ© car il vÃ©rifie les erreurs de syntaxe.

2. **Ajouter Albert directement dans le fichier sudoers :**
   Recherchez la ligne qui commence par `%sudo` et ajoutez une ligne pour Albert juste en dessous :
   ```bash
   albert ALL=(ALL:ALL) ALL
   ```

   Cela permet Ã  `albert` d'exÃ©cuter toutes les commandes en tant que n'importe quel utilisateur ou groupe.

# MÃ©thode 3 : Utiliser des groupes spÃ©cifiques pour les privilÃ¨ges sudo

1. **CrÃ©er un groupe spÃ©cifique pour sudo :**
   ```bash
   sudo groupadd admin
   ```

2. **Ajouter Albert au groupe admin :**
   ```bash
   sudo usermod -aG admin albert
   ```

3. **Modifier le fichier sudoers pour inclure le groupe admin :**
   Ouvrez le fichier sudoers :
   ```bash
   sudo visudo
   ```

   Et ajoutez la ligne suivante :
   ```bash
   %admin ALL=(ALL) ALL
   ```

# MÃ©thode 4 (Ã€ IGNORER): Utiliser des scripts pour automatiser le processus

1. **CrÃ©er un script shell pour ajouter des utilisateurs :**
   ```bash
   #!/bin/bash

   # VÃ©rifier si le script est exÃ©cutÃ© en tant que root
   if [ "$(id -u)" -ne 0 ]; then
       echo "Ce script doit Ãªtre exÃ©cutÃ© avec les privilÃ¨ges root."
       exit 1
   fi

   # Lire le nom de l'utilisateur
   read -p "Entrez le nom de l'utilisateur : " username

   # CrÃ©er l'utilisateur
   adduser $username

   # Ajouter l'utilisateur au groupe sudo
   usermod -aG sudo $username

   echo "L'utilisateur $username a Ã©tÃ© crÃ©Ã© et ajoutÃ© au groupe sudo."
   ```

2. **Rendre le script exÃ©cutable et l'exÃ©cuter :**
   ```bash
   chmod +x create_sudo_user.sh
   sudo ./create_sudo_user.sh
   ```

#### MÃ©thode 5 : Utiliser Ansible pour gÃ©rer les utilisateurs (IgnorÃ© pour les Ã©tudiants)

Ansible est un outil d'automatisation qui peut gÃ©rer les configurations Ã  grande Ã©chelle. Cette mÃ©thode peut Ãªtre ignorÃ©e par les Ã©tudiants.

1. **Installer Ansible :**
   ```bash
   sudo apt update
   sudo apt install ansible -y
   ```

2. **CrÃ©er un playbook Ansible pour ajouter un utilisateur sudo :**
   ```yaml
   ---
   - name: Ajouter un utilisateur et l'ajouter au groupe sudo
     hosts: localhost
     become: true
     tasks:
       - name: Ajouter un nouvel utilisateur
         user:
           name: albert
           state: present
           groups: sudo
           append: yes
   ```

3. **ExÃ©cuter le playbook Ansible :**
   ```bash
   ansible-playbook ajouter_utilisateur.yml
   ```

# Conclusion

Chaque mÃ©thode a ses avantages en fonction du contexte et des besoins spÃ©cifiques. Utiliser la ligne de commande est simple et direct, tandis que l'utilisation de scripts permet d'automatiser le processus, ce qui est utile pour gÃ©rer un grand nombre d'utilisateurs.


-----

ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡
# OPTION 5
ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡ğŸ¥‡


### Exercice : Gestion des Utilisateurs et des Permissions

#### Objectif :
CrÃ©er plusieurs utilisateurs, leur attribuer des permissions spÃ©cifiques sur des fichiers, des dossiers et des scripts.

#### Consignes :
1. **CrÃ©er les utilisateurs :**
   - CrÃ©ez les utilisateurs suivants : `albert`, `bernard`, `claude`, `danielle`.
   - Attribuez un mot de passe Ã  chaque utilisateur.

2. **Attribuer des permissions spÃ©cifiques :**
   - CrÃ©ez les fichiers et dossiers suivants :
     - `/home/shared_data`
     - `/home/shared_data/file1.txt`
     - `/home/shared_data/file2.txt`
     - `/home/shared_data/dossier1`
     - `/home/shared_data/dossier1/script1.sh`
     - `/home/shared_data/dossier1/script2.sh`

3. **Attribuer les permissions :**
   - `albert` doit pouvoir lire et Ã©crire dans `/home/shared_data/file1.txt`, mais seulement lire `/home/shared_data/file2.txt`.
   - `bernard` doit pouvoir lire et Ã©crire dans `/home/shared_data/file2.txt` et exÃ©cuter `/home/shared_data/dossier1/script1.sh`.
   - `claude` doit pouvoir lire et Ã©crire dans `/home/shared_data/dossier1` mais ne doit pas pouvoir exÃ©cuter les scripts prÃ©sents dans ce dossier.
   - `danielle` doit avoir tous les droits (lecture, Ã©criture, exÃ©cution) sur tous les fichiers et dossiers.

#### Tableau des Permissions

| Utilisateur | Fichier/Dossier                      | Permissions                            |
|-------------|--------------------------------------|----------------------------------------|
| albert      | /home/shared_data/file1.txt          | Lecture, Ã‰criture                      |
| albert      | /home/shared_data/file2.txt          | Lecture                                |
| bernard     | /home/shared_data/file2.txt          | Lecture, Ã‰criture                      |
| bernard     | /home/shared_data/dossier1/script1.sh| ExÃ©cution                              |
| claude      | /home/shared_data/dossier1           | Lecture, Ã‰criture                      |
| claude      | /home/shared_data/dossier1/script1.sh| Aucune                                 |
| claude      | /home/shared_data/dossier1/script2.sh| Aucune                                 |
| danielle    | /home/shared_data/file1.txt          | Lecture, Ã‰criture, ExÃ©cution           |
| danielle    | /home/shared_data/file2.txt          | Lecture, Ã‰criture, ExÃ©cution           |
| danielle    | /home/shared_data/dossier1           | Lecture, Ã‰criture, ExÃ©cution           |
| danielle    | /home/shared_data/dossier1/script1.sh| Lecture, Ã‰criture, ExÃ©cution           |
| danielle    | /home/shared_data/dossier1/script2.sh| Lecture, Ã‰criture, ExÃ©cution           |

#### Instructions pour les Ã‰tudiants :

##### Ã‰tape 1 : CrÃ©er les Utilisateurs

1. **CrÃ©er les utilisateurs :**
   ```bash
   sudo adduser albert
   sudo adduser bernard
   sudo adduser claude
   sudo adduser danielle
   ```

##### Ã‰tape 2 : CrÃ©er les Fichiers et Dossiers

1. **CrÃ©er le dossier `shared_data` et ses sous-dossiers et fichiers :**
   ```bash
   sudo mkdir -p /home/shared_data/dossier1
   sudo touch /home/shared_data/file1.txt /home/shared_data/file2.txt
   sudo touch /home/shared_data/dossier1/script1.sh /home/shared_data/dossier1/script2.sh
   sudo chmod +x /home/shared_data/dossier1/script1.sh /home/shared_data/dossier1/script2.sh
   ```

##### Ã‰tape 3 : Attribuer les Permissions

1. **Attribuer les permissions Ã  `albert` :**
   ```bash
   sudo setfacl -m u:albert:rw /home/shared_data/file1.txt
   sudo setfacl -m u:albert:r /home/shared_data/file2.txt
   ```

2. **Attribuer les permissions Ã  `bernard` :**
   ```bash
   sudo setfacl -m u:bernard:rw /home/shared_data/file2.txt
   sudo setfacl -m u:bernard:x /home/shared_data/dossier1/script1.sh
   ```

3. **Attribuer les permissions Ã  `claude` :**
   ```bash
   sudo setfacl -m u:claude:rw /home/shared_data/dossier1
   sudo setfacl -x u:claude /home/shared_data/dossier1/script1.sh
   sudo setfacl -x u:claude /home/shared_data/dossier1/script2.sh
   ```

4. **Attribuer les permissions Ã  `danielle` :**
   ```bash
   sudo setfacl -m u:danielle:rwx /home/shared_data/file1.txt
   sudo setfacl -m u:danielle:rwx /home/shared_data/file2.txt
   sudo setfacl -m u:danielle:rwx /home/shared_data/dossier1
   sudo setfacl -m u:danielle:rwx /home/shared_data/dossier1/script1.sh
   sudo setfacl -m u:danielle:rwx /home/shared_data/dossier1/script2.sh
   ```

##### VÃ©rification

Pour vÃ©rifier que les permissions ont Ã©tÃ© correctement attribuÃ©es, chaque utilisateur peut exÃ©cuter les commandes suivantes :

1. **VÃ©rifier les permissions de `file1.txt` et `file2.txt` :**
   ```bash
   getfacl /home/shared_data/file1.txt
   getfacl /home/shared_data/file2.txt
   ```

2. **VÃ©rifier les permissions des scripts :**
   ```bash
   getfacl /home/shared_data/dossier1/script1.sh
   getfacl /home/shared_data/dossier1/script2.sh
   ```

3. **Tester les accÃ¨s en se connectant en tant que chaque utilisateur :**
   ```bash
   su - albert
   cat /home/shared_data/file1.txt
   echo "Test" >> /home/shared_data/file1.txt
   cat /home/shared_data/file2.txt

   su - bernard
   echo "Test" >> /home/shared_data/file2.txt
   /home/shared_data/dossier1/script1.sh

   su - claude
   echo "Test" >> /home/shared_data/dossier1
   /home/shared_data/dossier1/script1.sh  # devrait Ã©chouer

   su - danielle
   cat /home/shared_data/file1.txt
   echo "Test" >> /home/shared_data/file1.txt
   /home/shared_data/dossier1/script1.sh
   ```

### Conclusion

Cet exercice permet aux Ã©tudiants de pratiquer la crÃ©ation d'utilisateurs, l'attribution de permissions spÃ©cifiques et la gestion des accÃ¨s sur un systÃ¨me Kali Linux. Assurez-vous qu'ils comprennent l'importance de chaque Ã©tape et de la sÃ©curitÃ© dans la gestion des permissions.

